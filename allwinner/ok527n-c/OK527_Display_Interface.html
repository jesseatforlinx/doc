

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Display Interface &mdash; Forlinx Embedded T527 Documentation  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=30170994" />

  
    <link rel="shortcut icon" href="_static/forlinx.png"/>
    <link rel="canonical" href="https://forlinxembedded.github.io/allwinner/ok527n-c/OK527_Display_Interface.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Quick Boot" href="OK527_Quick_Boot.html" />
   

  <!-- Load Font Awesome from CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-N8EJPNL8NR"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-N8EJPNL8NR');
  </script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/forlinx-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">SOFTWARE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="OK527N-C_Linux5.15.47_User_Manual.html">Linux5.15.147_User’s Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="OK527N-C_Linux5.15.47_User_Compilation_Manual.html">Linux5.15.147_User’s Compilation Manual</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">APPLICATION NOTE</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="OK527_Quick_Boot.html">Quick Boot</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Display Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#copyright">Copyright</a></li>
<li class="toctree-l2"><a class="reference internal" href="#application-scope">Application Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debugging-of-mipi-screen-initialization-sequence">Debugging of MIPI Screen Initialization Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modification-method">Modification Method</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Forlinx Embedded T527 Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Display Interface</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="display-interface">
<h1>Display Interface<a class="headerlink" href="#display-interface" title="Link to this heading"></a></h1>
<p>Document classification: □ Top secret □ Secret □ Internal information ■ Open</p>
<section id="copyright">
<h2>Copyright<a class="headerlink" href="#copyright" title="Link to this heading"></a></h2>
<p>The copyright of this manual belongs to Baoding Folinx Embedded Technology Co., Ltd. Without the written permission of our company, no organizations or individuals have the right to copy, distribute, or reproduce any part of this manual in any form, and violators will be held legally responsible.</p>
<p>Forlinx adheres to copyrights of all graphics and texts used in all publications in original or license-free forms.</p>
<p>The drivers and utilities used for the components are subject to the copyrights of the respective manufacturers. The license conditions of the respective manufacturer are to be adhered to. Related license expenses for the operating system and applications should be calculated/declared separately by the related party or its representatives.</p>
</section>
<section id="application-scope">
<h2>Application Scope<a class="headerlink" href="#application-scope" title="Link to this heading"></a></h2>
<p>This manual is primarily applicable to the Forlinx OKT527 platform running Linux5.15. It can be used as a reference for other platforms, but differences between platforms may exist, and customers will need to modify it to suit their own use.</p>
</section>
<section id="debugging-of-mipi-screen-initialization-sequence">
<h2>Debugging of MIPI Screen Initialization Sequence<a class="headerlink" href="#debugging-of-mipi-screen-initialization-sequence" title="Link to this heading"></a></h2>
<p>This test is based on the user materials of OK527 - C &amp; OK527N - C_Linux5.15.147 + Qt5.15.8. The old BSP does not support this modification.</p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>For T527 screen debugging, the U - Boot device tree and the kernel device tree need to be modified respectively. Currently, the U - Boot source code is not open - sourced. You can first debug the kernel. After the kernel works normally, contact us to debug the U - Boot.</p>
<p>device/config/chips/t527/configs/okt527/uboot-board.dts</p>
<p>kernel/linux-5.15/arch/arm64/boot/dts/allwinner/OKT527-C-Common.dtsi</p>
<p>Adjusting the parameters of the MIPI screen is not very different from other screens. You need to configure the pins, backlight, and screen parameters. Only some MIPI screens need to add an initialization sequence.</p>
</section>
<section id="modification-method">
<h2>Modification Method<a class="headerlink" href="#modification-method" title="Link to this heading"></a></h2>
<p>Take the kernel device tree as an example, and the same applies to the U - Boot device tree.</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>&amp;dsi0 {
        status = &quot;disabled&quot;;
        pinctrl-0 = &lt;&amp;dsi0_4lane_pins_a&gt;;	//Configure pins
        pinctrl-1 = &lt;&amp;dsi0_4lane_pins_b&gt;;	//Configure pins
        pinctrl-names = &quot;active&quot;,&quot;sleep&quot;;

        panel: panel@0 {
                compatible = &quot;allwinner,virtual-panel&quot;;
                status = &quot;okay&quot;;
                reg = &lt;0&gt;;
                power0-supply = &lt;&amp;reg_cldo3&gt;;
                power1-supply = &lt;&amp;reg_dcdc4&gt;;
                power2-supply = &lt;&amp;reg_cldo1&gt;;

                backlight = &lt;&amp;backlight0&gt;;	//Backlight configuration. Note that the backlight enable pin PI12 needs to be commented out.
                //Or replace it with the actually used pin, as there is a discrepancy here with the hardware.

        power-delay-ms = &lt;0&gt;;
        reset-delay-ms = &lt;0&gt;;								//Reset pin delay
        enable-delay-ms = &lt;0&gt;;
        reset-gpios = &lt;&amp;pio PI 12 GPIO_ACTIVE_HIGH&gt;;	//Configure the screen&#39;s reset pin, and remap the backlight enable pin to this location according to the hardware design.
        width-mm = &lt;68&gt;;										//Screen width
        height-mm = &lt;121&gt;;									//Screen height

        dsi,flags = &lt;(MIPI_DSI_MODE_VIDEO | MIPI_DSI_MODE_VIDEO_BURST | MIPI_DSI_MODE_NO_EOT_PACKET)&gt;;
        dsi,format = &lt;0&gt;; //&lt;MIPI_DSI_FMT_RGB888&gt;;
        dsi,lanes  = &lt;4&gt;;		//Lane number configuration
        panel-init-sequence = [	//Initialization sequence
            ];
      //  panel-exit-sequence = [	//Close the sequence, some screens require
      //      ];

                display-timings {
                        native-mode = &lt;&amp;dsi_timing0&gt;;

                        dsi_timing0: timing0 {	//Screen parameter configuration
                hback-porch     = &lt;48&gt;;
                hfront-porch    = &lt;40&gt;;
                hactive         = &lt;1024&gt;;
                hsync-len       = &lt;48&gt;;
                vback-porch     = &lt;48&gt;;
                vfront-porch    = &lt;40&gt;;
                vactive         = &lt;600&gt;;
                vsync-len       = &lt;4&gt;;
                clock-frequency = &lt;45000000&gt;;
                vsync-active    = &lt;0&gt;;
                hsync-active    = &lt;0&gt;;
                de-active       = &lt;0&gt;;
                pixelclk-active = &lt;0&gt;;
                        };
                };
</pre></div>
</div>
<p>The above is the content of DSI. The initialization sequence needs to be filled in according to Allwinner’s defined logic. Generally, the initialization provided by the screen manufacturer is added in the driver. So the format is generally as follows:</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>#if 1 //zheng shao
SPI_WriteComm(0xFF);
SPI_WriteData(0x77);
SPI_WriteData(0x01);
SPI_WriteData(0x00);
SPI_WriteData(0x00);
SPI_WriteData(0x10);

SPI_WriteComm(0xC0);
SPI_WriteData(0x3B);	
SPI_WriteData(0x00);
··· ···							//Part of the content is omitted
SPI_WriteComm(0x11);

Delay(120);

SPI_WriteComm(0x29);

SPI_WriteComm(0x36);
SPI_WriteData(0x00);

SPI_WriteComm(0x3A);
SPI_WriteData(0x60);
#endif
</pre></div>
</div>
<p>After modification, it should be:</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>39 00 06 FF 77 01 00 00 10
39 00 03 C0 3B 00
··· ···										//Part of the content is omitted
05 78 01 11
05 00 01 29
15 00 02 36 00
15 00 02 3A 60
</pre></div>
</div>
<p>The original data format is: Write several data sequentially at a certain address.</p>
<p>The new data format is: [Packet type][Sending delay][Data length][*n MIPI screen initialization data] // Hexadecimal numbers</p>
<p>Packet type: When the length of the written data is 1, 2, 3, and above, it is 05, 15, 39 respectively.</p>
<p>Sending delay: Fill in 00 when there is no delay. If there is a delay, convert it to a hexadecimal number. For example, the above - mentioned delay of 120 corresponds to 78.</p>
<p>Data length: It refers to the number of bytes of the original address and data. For example, in the first group, 0x77 0x01 0x00 0x00 0x10 are written sequentially at 0xff, a total of 5 bytes, so the total is 6 bytes.</p>
<p>Initialization data: Fill in the address and data of the original data.</p>
<p>Some original data are in the following format, which are arranged according to the address, the number of data, and the data value.</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>{0x9B,12,{0x03,0x6A,0x03,0x7F,0x03,0x96,0x03,0xB7,0x03,0xDF,0x03,0xFF}},
{0x36,1,{0x0A}},
{0x11,0,{0x00}},
{REGFLAG_DELAY, 120, {}},
</pre></div>
</div>
<p>Similarly, count the address and the number of data, determine the delay, and fill them in according to Allwinner’s format.</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>39 00 0d 9b 03 6a 03 7f 03 96 03 b7 03 df 03 ff
15 00 02 36 0a
05 78 01 11 
</pre></div>
</div>
<p>Fill all the initialization sequences into the device tree according to the above - mentioned format. After modifying other screen parameters, compile and test the display of the MIPI screen.</p>
<p>If there is still no display, check the backlight, measure the pin waveforms of the MIPI screen, and confirm that the initialization sequence is written successfully. If the screen shows a garbled image, adjust the screen parameters.</p>
</section>
</section>


           </div>
          </div>
          <div class="forlinx-footer-social" style="margin-top: 15px; padding: 0 16px;">
  <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">

    <!-- 左侧版权信息 -->
    <span style="font-size: 14px; color: #444;">
      © <a href="https://www.forlinx.net/" target="_blank" style="color: inherit; text-decoration: none;">Forlinx Embedded</a>
    </span>

    <!-- 右侧社交图标 -->
    <div>
      <a href="https://www.facebook.com/Forlinx-Embedded-177890724336237" target="_blank">
        <i class="fab fa-facebook fa-lg" style="margin: 0 6px; color:#3b5998;"></i>
      </a>
      <a href="https://www.linkedin.com/company/forlinx-embedded-technology-co-ltd/" target="_blank">
        <i class="fab fa-linkedin fa-lg" style="margin: 0 6px; color:#0077b5;"></i>
      </a>
      <a href="https://x.com/ForlinxOfficial" target="_blank">
        <i class="fab fa-x-twitter fa-lg" style="margin: 0 6px; color:#000;"></i>
      </a>
      <a href="https://www.youtube.com/@forlinxembedded" target="_blank">
        <i class="fab fa-youtube fa-lg" style="margin: 0 6px; color:#FF0000;"></i>
      </a>
      <a href="https://github.com/ForlinxEmbedded" target="_blank">
        <i class="fab fa-github fa-lg" style="margin: 0 6px; color:#333;"></i>
      </a>
      <a href="https://www.forlinx.net/" target="_blank">
        <i class="fas fa-globe fa-lg" style="margin: 0 6px; color:#2274A5;"></i>
      </a>
    </div>

  </div>
</div>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>